#!/bin/sh

ZFS_DATASET="scratch/ccasfs"
DATASET_ID="${1}"
shift
if [ "x" != "x${1}" ]; then
    ZFS_DATASET="${1}"
    shift
fi

while mount | grep /ccasfs/${DATASET_ID} ; do
    echo umount -f /ccasfs/${DATASET_ID}
    umount -f /ccasfs/${DATASET_ID}
done

pkill ${ZFS_DATASET}

umount -f /${ZFS_DATASET}/_ccasfs_${DATASET_ID}/tmp/

zfs destroy -r ${ZFS_DATASET}
